# 동적 속성과 프로퍼티

파이썬에서는 데이터 속성과 메서드를 통틀어 **속성**이라고 한다. 메서드는 단지 **호출할 수 있는** 속성일 뿐이다. 데이터 속성과 메서드 외에도 프로퍼티를 정의할 수 있다. 프로퍼티를 사용하면 클래스 인터페이스를 변경하지 않고도 공개 데이터 속성을 **접근자 메서드**(즉, 게터(getter)와 세터(setter))로 대체할 수 있다. 이것은 다음과 같은 **통일된 접근 원칙**에도 부합한다.

**모듈이 제공하는 모든 서비스는 통일된 표기법을 이용해서 접근할 수 있어야 한다. 통일된 표기법은 저장소를 이용해서 구현하거나 계산을 통해 구현하는 경우에도 모두 동일하게 적용된다.**

프로퍼티 외에도 파이썬은 속성에 대한 접근을 제어하고 동적 속성을 구현할 수 있는 풍부한 API를 제공한다. 파이썬 인터프리터는 obj.attr과 같은 점 표기법으로 표현된 속성에 대한 접근을 __getattr__()과 __setattr__() 등 특별 메서드를 호출해서 평가한다. __getattr__() 메서드를 구현하는 사용자 정의 클래스는 obj.no_such_attribute처럼 실제로 존재하지 않는 속성을 실행 도중에 계산함으로써 '가상 속성'을 구현할 수 있다.

동적 속성을 구현하는 것은 프레임워크 개발자들이 하는 작업과 비슷하다. 그러나 파이썬에서는 기본적인 기법이 상당히 간단하므로 누구나 사용할 수 있고, 심지어 일상적으로 수행하는 데이터 랭글링 작업에도 사용할 수 있다. 이 장은 데이터 랭글링부터 시작한다.

# 요약

먼저 JSON 데이터 피드를 처리하기 쉽게 해주는 간단한 실용적인 예제를 보면서 동적 속성에 대한 설명을 시작했다. 첫 번째로 구현한 FrozenJSON 클래스는 내포된 딕셔너리와 리스트를 내포된 FrozenJSON 객체 및 FrozenJSON 객체의 리스트로 변환한다. FrozenJSON 클래스는 __getattr__() 특별 메서드를 이용해서 속성을 읽을 때마다 즉석에서 데이터 구조체를 변환하는 방법을 보여준다. FrozenJSON의 마지막 버전은 클래스를 객체 팩토리로 만들어주는 __new__() 생성자 메서드의 사용법을 보여준다. __new__()는 자기 클래스 객체뿐만 아니라 어떠한 객체도 생성할 수 있다.

그러고 나서 JSON 피드를 직렬화된 Record 클래스 객체를 저장하는 shelve.Shelf 데이터베이스로 변환했다. Record의 첫 번째 버전은 단지 몇 줄 짜리 코드로서, __init__()에 전달된 임의의 키워드 인수로부터 속성을 생성하기 위해 사용하는 self.__dict__.update (**kwargs) '묶음' 관용구를 소개했다. 이 예제의 두 번째 버전에서는 데이터베이스와 통합하기 위한 DbRecord 클래스와 프로퍼티를 통해 연결된 레코드를 자동으로 가져오는 Event 클래스를 이용해서 Record 클래스를 확장했다.

프로퍼티에 대한 설명은 LineItem 클래스로 이어졌다. 여기에서는 프로퍼티를 활용해서 weight 속성이 음수나 0이 되지 않게 보호했다. 프로퍼티 구문과 의미에 대해 자세히 살펴본 후, 게터와 세터를 중복해서 구현할 필요 없이 weight와 price를 동일하게 검증하기 위해 프로퍼티 팩토리를 만들었다. 프로퍼티 팩토리는 클로저 개념 및 프로퍼티에 의해 가려지는 객체 속성 개념을 활용해서 하드코딩된 프로퍼티 라인수로 세련된 범용 프로퍼티를 만들 수 있게 해준다.

마지막으로 프로퍼티를 이용해서 속성을 제거하는 방법 및 핵심 파이썬 언어에서 속성 메타프로그래밍을 지원하는 핵심적인 특별 속성, 내장 함수, 특별 메서드에 대해 간략히 살펴봤다.