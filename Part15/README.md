<!-- 
[UML클래스전략패턴](https://github.com/hyeonDD/fluent_python/blob/master/Part15/ex54-1/UML_class_diagram.png)
 -->
# 콘텍스트 관리자와 else 블록

콘겟트그 관리자는 서브루틴 자체만큼 중요해질지도 모른다.
단지 빙삭의 일각만 보았을 뿐이다.
Basic 언어에는 with 문이 있다.
with 문을 가진 언어가 많이 있지만, 파이썬의 with문과는 다르다.
다른 언어에서의 with 문은 단지 피상적인 작업을 수행하고,
점으로 명시한 속성을 반복적으로 검색할 필요 없게 해주지만,
준비와 마무리 과정은 처리하지 않는다.
단지 이름이 똑같다고 해서 똑같은 것이라고 생각하면 안 된다.
파이썬의 with 문은 정말 대단하다
**- 레이모드 헤팅거 파이썬 에반젤리스트**

이 장에서는 다른 언어에서 흔히 볼 수 없기 때문에 파이썬에서도 잘 사용되지 않는 다음과 같은 제어 기능을 살펴본다.
* with 문과 콘텍스트 관리자
* for, while, try 문에서의 else 블록

with 문은 콘텍스트 관리자 객체의 제어를 받아서 임시로 콘텍스트를 생성하고 신뢰성 있게 해제한다. with 문은 에러를 예방하고 반복되는 코드를 줄여주며, API를 안전하고 편리하게 사용할 수 있게 해만들어준다. 파이썬 프로그래머는 파일을 자동으로 닫아주는 기능 이상을 with문이 제공하고 있음을 알고 있다.
else 절은 with 문과 전혀 상관없지만, 벌써 5부에 들어섰는데, 아직 else를 설명할 마땅한 부분이 없었기 때문에 이 장에서 함께 설명한다.

이 장에서 설명할 실제 주제에 들어가기 전에 간단한 주제부터 다루자.

# 요약
이 장에서는 쉬운 주제인 for, while, try 문에서 사용하는 else 블록에 대한 설명으로 시작했다. 이러한 문장에서 else 절의 특별한 의미에 익숙해진 후에는 여러분의 의도를 else를 이용해서 명확히 표현할 수 있을 것이라고 생각한다.

그러고 나서 콘텍스트 관리자와 with 문의 의미를 설명하면서, 자동으로 파일을 닫는 일반적인 용법보다 고차원적인 용법을 살펴보았다. 그리고 __enter__()와 __exit__()메서드를 가진 콘텍스트 관리자인 LookingGlass 클래스를 구현하고, __exit__() 메서드에서 예외를 처리하는 방법을 살펴보았다. 레이몬드 헤팅거가 PyCon US 2013 키노트에서 발표한 내용의 핵심은 with 문이 단지 리소스 관리를 위한 것이 아니라, 공통적인 준비와 마무리 작업 또는 다른 프로시저의 전과 후에 수행해야 할 연산을 인수 분해하는 도구라는 것이다('파이썬이 멋진 이유?' (http://bit.ly/1MM9pCm) 의 21번째 슬라이드).

마지막으로, contextlib 표준 라이브러리 모듈에 있는 함수들을 살펴보았다. 그중 하나인 @contextmanager 데커레이터는 하나의 yield 문을 가진 간단한 제너레이터를 이용해서 콘텍스트 관리자를 구현할 수 있게 해준다 (제너레이터를 사용하면 최소 2개의 메서드를 가진 클래스를 정의하는 것보다 가볍게 콘텍스트 관리자를 만들 수 있다). 우리는 LookingGlass 클래스를 looking_glass() 제너레이터 함수로 다시 구현하고, @contextmanager 데커레이터를 사용할 때 에외를 처리하는 방법에 대해 이야기 했다.

@contextmanager 데커레이터는 서로 독립적으로 제공되는 함수 데커레이터, 제너레이터, with문 등 총 3개의 기능을 통합하는 세련되고 실용적인 도구다.